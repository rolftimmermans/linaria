{"version":3,"file":"cache.js","names":["MemoryCache","cache","Map","dependenciesCache","get","key","Promise","resolve","set","value","getDependencies","setDependencies","memoryCache","getCacheInstance","cacheProvider","require","Error"],"sources":["../src/cache.ts"],"sourcesContent":["export interface ICache {\n  get: (key: string) => Promise<string>;\n  set: (key: string, value: string) => Promise<void>;\n  getDependencies?: (key: string) => Promise<string[]>;\n  setDependencies?: (key: string, value: string[]) => Promise<void>;\n}\n\n// memory cache, which is the default cache implementation in Linaria\n\nclass MemoryCache implements ICache {\n  private cache: Map<string, string> = new Map();\n\n  private dependenciesCache: Map<string, string[]> = new Map();\n\n  public get(key: string): Promise<string> {\n    return Promise.resolve(this.cache.get(key) ?? '');\n  }\n\n  public set(key: string, value: string): Promise<void> {\n    this.cache.set(key, value);\n    return Promise.resolve();\n  }\n\n  public getDependencies(key: string): Promise<string[]> {\n    return Promise.resolve(this.dependenciesCache.get(key) ?? []);\n  }\n\n  public setDependencies(key: string, value: string[]): Promise<void> {\n    this.dependenciesCache.set(key, value);\n    return Promise.resolve();\n  }\n}\n\nexport const memoryCache = new MemoryCache();\n\n/**\n * return cache instance from `options.cacheProvider`\n * @param cacheProvider string | ICache | undefined\n * @returns ICache instance\n */\nexport const getCacheInstance = async (\n  cacheProvider: string | ICache | undefined\n): Promise<ICache> => {\n  if (!cacheProvider) {\n    return memoryCache;\n  }\n  if (typeof cacheProvider === 'string') {\n    return require(cacheProvider);\n  }\n  if (\n    typeof cacheProvider === 'object' &&\n    'get' in cacheProvider &&\n    'set' in cacheProvider\n  ) {\n    return cacheProvider;\n  }\n  throw new Error(`Invalid cache provider: ${cacheProvider}`);\n};\n"],"mappings":";;;;;;AAOA;;AAEA,MAAMA,WAAW,CAAmB;EAC1BC,KAAK,GAAwB,IAAIC,GAAG,EAAE;EAEtCC,iBAAiB,GAA0B,IAAID,GAAG,EAAE;EAErDE,GAAG,CAACC,GAAW,EAAmB;IAAA;IACvC,OAAOC,OAAO,CAACC,OAAO,oBAAC,IAAI,CAACN,KAAK,CAACG,GAAG,CAACC,GAAG,CAAC,6DAAI,EAAE,CAAC;EACnD;EAEOG,GAAG,CAACH,GAAW,EAAEI,KAAa,EAAiB;IACpD,IAAI,CAACR,KAAK,CAACO,GAAG,CAACH,GAAG,EAAEI,KAAK,CAAC;IAC1B,OAAOH,OAAO,CAACC,OAAO,EAAE;EAC1B;EAEOG,eAAe,CAACL,GAAW,EAAqB;IAAA;IACrD,OAAOC,OAAO,CAACC,OAAO,0BAAC,IAAI,CAACJ,iBAAiB,CAACC,GAAG,CAACC,GAAG,CAAC,yEAAI,EAAE,CAAC;EAC/D;EAEOM,eAAe,CAACN,GAAW,EAAEI,KAAe,EAAiB;IAClE,IAAI,CAACN,iBAAiB,CAACK,GAAG,CAACH,GAAG,EAAEI,KAAK,CAAC;IACtC,OAAOH,OAAO,CAACC,OAAO,EAAE;EAC1B;AACF;AAEO,MAAMK,WAAW,GAAG,IAAIZ,WAAW,EAAE;;AAE5C;AACA;AACA;AACA;AACA;AAJA;AAKO,MAAMa,gBAAgB,GAAG,MAC9BC,aAA0C,IACtB;EACpB,IAAI,CAACA,aAAa,EAAE;IAClB,OAAOF,WAAW;EACpB;EACA,IAAI,OAAOE,aAAa,KAAK,QAAQ,EAAE;IACrC,OAAOC,OAAO,CAACD,aAAa,CAAC;EAC/B;EACA,IACE,OAAOA,aAAa,KAAK,QAAQ,IACjC,KAAK,IAAIA,aAAa,IACtB,KAAK,IAAIA,aAAa,EACtB;IACA,OAAOA,aAAa;EACtB;EACA,MAAM,IAAIE,KAAK,CAAE,2BAA0BF,aAAc,EAAC,CAAC;AAC7D,CAAC;AAAC"}